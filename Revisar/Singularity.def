Bootstrap: docker
From: ubuntu:22.04

%labels
    Maintainer Dan Vidal Gojgarea
    Description Contenedor para extracción de estadísticas con Python, samtools, jq y pybedtools.

%environment
    export LC_ALL=C
    export PATH=/usr/local/bin:$PATH

%post
    # Evitar interacción
    export DEBIAN_FRONTEND=noninteractive

    # Actualización y herramientas básicas
    apt-get update && apt-get install -y \
        samtools \
        jq \
        python3 \
        python3-pip \
        curl \
        bedtools \
        git \
        build-essential \
        zlib1g-dev \
        libbz2-dev \
        liblzma-dev \
        libcurl4-openssl-dev \
        libncurses5-dev \
        libncursesw5-dev \
        libssl-dev \
        libffi-dev \
        libsqlite3-dev \
        wget \
        && apt-get clean

    # Alias python
    ln -s /usr/bin/python3 /usr/bin/python

    # Actualizar pip e instalar librerías Python
    pip3 install --upgrade pip
    pip3 install pandas numpy pybedtools

    # Verificación
    echo "✅ Singularity container listo con samtools, jq, Python3, pandas, numpy, pybedtools y bedtools"

%runscript
    echo "Este contenedor está preparado para análisis de estadísticas del proyecto Sarek con Nextflow."
    exec "$@"

#Comando terminal: singularity build sarek-stats-env.sif Singularity.def